# 任务计划：Tabs / Card / Tag / Badge / Avatar（Phase 8）

## 一、背景与本轮目标

在前几轮（`plan/0001`–`0010`）中，已经完成：

- 布局与导航：Layout / Grid / Flex / Space / Masonry / Splitter / Menu / Breadcrumb / Pagination；
- 表单与输入：Input / TextArea / Checkbox / Radio / Switch / Upload + Form 高级能力；
- 选择器家族：Select / TreeSelect / Cascader / AutoComplete，与 Form 深度集成；
- 浮层体系：App / ConfigProvider / OverlayManager / Tooltip / Popover / Popconfirm / Dropdown / Modal / Drawer / Message / Notification；
- 数据展示与状态：Typography / Divider / List / Table / Empty / Spin / Skeleton / FloatButton；
- 组合示例：`layout_navigation_demo`、`data_view_demo` 等基础中后台页面骨架。

对照 Ant Design 6.0，还缺失一组高频但相对独立、非常适合组合使用的组件：

- `Tabs`：页面内多视图切换（列表/详情、基础信息/高级设置）；
- `Card`：卡片容器，承载列表卡片、统计信息、表单块等；
- `Tag`：状态/类别标签，用于表示枚举、筛选条件、标签云；
- `Badge`：数量角标/小红点，与导航/操作入口联动；
- `Avatar`：用户/应用头像，常出现在顶部导航和列表中。

本轮（Phase 8）目标：

- 设计并实现 Tabs / Card / Tag / Badge / Avatar 的 MVP 版本；
- 与现有 Layout / Menu / Breadcrumb / Pagination / List / Table / Form / Dropdown 深度协同，补齐中后台常见「导航 + 卡片 + 标签/角标 + 列表」场景；
- 通过 demo 与文档整理一套「用户中心 / 仪表盘 / 设置页」的推荐组合方式。

> 仍采用 MVP 策略：优先覆盖实际业务中的常见用法，暂不追求 AntD 在动画、复杂样式和所有变体上的完全对齐。

---

## 二、设计原则

1. **对齐 AntD 语义，裁剪复杂变体**
   - Tabs：先支持 `tabs` + `activeKey` + `onChange` 的基础模式，暂不实现可编辑卡片、拖拽排序、多行滚动等；
   - Card：先实现基础卡片（标题/extra/内容），Grid/Meta 等复杂组合后续考虑；
   - Tag：优先实现状态色/可关闭/多选标签，CheckableTag 高级形态可后续补充；
   - Badge：先支持数字/小红点/overflowCount，不做 `status` 全形态；
   - Avatar：支持图片/文字头像/预设颜色，Group/形状/尺寸覆盖常见用法即可。

2. **与 Theme/ConfigProvider 统一**
   - 尺寸：受 `ComponentSize` 影响（small/middle/large），Tabs/Card/Tag/Badge/Avatar 行高与 Typography/Button 保持一致；
   - 颜色：复用现有 theme token（primary/success/warning/error/text 等），避免在组件内部硬编码颜色；
   - 圆角：统一使用 `--adui-radius` / `--adui-radius-sm`，卡片边框与 List/Table 对齐。

3. **受控优先 + 简单非受控兜底**
   - Tabs：`active_key` 受控优先，提供 `default_active_key` 作为非受控初始值；
   - Tag/Badge：展示类组件主打受控；
   - Avatar：基本为纯展示组件。

4. **组合优先，避免重复造轮子**
   - Tabs 内部内容不负责数据加载，交给现有 List/Table/Form 组件；
   - Card 内部不重复实现排版组件，优先组合 Typography / List / Table；
   - Tag/Badge/Avatar 优先作为现有组件的装饰（Table 列、List 行、Menu 项、Button/Dropdown 等）。

5. **文档清晰标注与 AntD 差异**
   - 每个组件文档中明确当前缺失的能力和后续扩展方向（例如 Tabs 可关闭、Card Grid、Tag.Checkable 等），避免误用。

---

## 三、任务拆解与 TODO

### A. 能力范围梳理与 API 草案

- [x] A1：调研 `tmp/antd-6.0.0/es` 下以下目录源码与类型声明：
  - `tabs` / `card` / `tag` / `badge` / `avatar`；
  - 重点关注：
    - Tabs：`TabsProps`、`TabPaneProps`、`items` 模式、受控 `activeKey`/`onChange`；
    - Card：`CardProps`、`title`/`extra`/`actions`、边框与尺寸变体；
    - Tag：`TagProps`、颜色/状态/可关闭/checkable 标签；
    - Badge：`BadgeProps`、`count`/`overflowCount`/`dot`、status；
    - Avatar：`AvatarProps`、`src`/`icon`/`shape`/`size`/`gap` 等；
- [x] A2：结合现有组件能力，确认本轮 **MVP API 范围**：
  - Tabs：仅支持默认线型样式，items 模式 + 受控 `active_key` / `on_change`，暂不实现 editable-card、额外 more/dropdown 行为；
  - Card：基础卡片 + 简单 `extra`/`hoverable` 支持，可选 `loading` 占位，不实现 Grid/Meta 子组件；
  - Tag：支持预设状态色/可关闭/简单 checkable（布尔选中），暂不实现复杂 variant/自定义 icon/href；
  - Badge：支持数字/小红点/`overflow_count`，不实现 Ribbon/status 文案等扩展；
  - Avatar：支持图片/文字/简单 size/shape，AvatarGroup 作为可选 MVP（只做水平排列），不实现复杂溢出计数。
- [x] A3：在 `docs/app_config.md` 或新文档中增加一小节「导航 + 卡片 + 标签/角标」组合规划：
  - 说明 Tabs/Card/Tag/Badge/Avatar 在用户中心/仪表盘/设置页等场景中的定位；
  - 与 Menu/Breadcrumb/Pagination/List/Table 的组合建议。

---

### B. Tabs：页签导航

- [x] B1：设计 `TabsProps` 与 `TabItem` 数据模型（`src/components/tabs.rs`）：
  - 建议字段：
    - `items: Vec<TabItem>`（包含 `key: String` / `label: String` 或 `Element` / 可选 `disabled`）；
    - `active_key: Option<String>` / `default_active_key: Option<String>`；
    - `on_change: Option<Callback<String>>`；
    - `size: Option<ComponentSize>`；
    - `tab_position: Option<TabPosition>`（MVP 仅支持 top）；
    - `class` / `style`；
    - `children: Option<Element>`（可选 slot：允许自定义内容布局）。
- [x] B2：实现 `Tabs` 组件：
  - 受控模式优先：若 `active_key` 存在，仅通过 `on_change` 通知外部；
  - 非受控模式：内部维护 `current_key` 的 Signal；
  - 渲染结构：
    - `.adui-tabs` 根；
    - `.adui-tabs-nav` / `.adui-tabs-tab` / `.adui-tabs-tab-active`；
    - `.adui-tabs-content` 内部根据 `active_key` 切换内容；
  - 暂不实现可关闭标签、滚动/折叠、多行等高级特性。
- [x] B3：在 `src/theme.rs` 中新增 `.adui-tabs-*` 样式片段，并加入 `THEME_BASE_STYLE`：
  - 对齐 AntD 基础视觉：下划线式/卡片式风格二选一（MVP 先选一种）；
  - Hover/active 状态、高度/间距与 Button/Input 对齐。
- [x] B4：新增 `examples/tabs_demo.rs`：
  - 基础用法：3 个 Tab 切换简单内容；
  - 受控 Tabs：外部按钮切换 activeKey；
  - 与 List/Table 组合：不同 Tab 展示不同列表/表格视图（可复用现有 demo 数据）。
- [x] B5：文档：新增 `docs/tabs.md`：
  - 描述 Tabs API 与受控/非受控模式；
  - 与 Layout / Card / Pagination 组合的典型场景；
  - 标注未实现的能力（可关闭标签、滚动等）。

---

### C. Card：卡片容器

- [x] C1：设计 `CardProps`（`src/components/card.rs`）：
  - 字段建议：
    - `title: Option<Element>`；
    - `extra: Option<Element>`（右上角操作区，如按钮/链接）；
    - `bordered: bool`（默认 true）；
    - `size: Option<ComponentSize>`；
    - `loading: bool`（可选，与 Skeleton 简单联动，MVP 可直接展示骨架占位块）；
    - `hoverable: bool`；
    - `class` / `style`；
    - `children: Element`（卡片正文内容）。
- [x] C2：实现 `Card` 组件：
  - 渲染结构：`.adui-card` 根 + `.adui-card-head` + `.adui-card-body`；
  - `bordered` 决定边框；`hoverable` 控制 hover 降低阴影/上浮；
  - 若 `loading=true`，可内置简单 Skeleton（或直接提供占位块，后续与 Skeleton 深度集成）。
- [x] C3：在 `src/theme.rs` 中新增 `.adui-card-*` 样式：
  - 背景色、圆角、阴影/边框；
  - 不同 size 的 padding/行高；
  - 与 List/Table 的卡片列表视觉对齐。
- [x] C4：新增 `examples/card_demo.rs`：
  - 基础卡片：标题 + 正文；
  - 带 extra 的操作卡片（右上角按钮/链接）；
  - 卡片网格：使用 Grid/List/Masonry 包裹多个 Card，展示仪表盘风格布局。
- [x] C5：文档：新增 `docs/card.md`：
  - Card API 与常见布局（单列/多列卡片）；
  - 与 Layout/Grid/Masonry、Tabs、List/Table 的组合建议。

---

### D. Tag：状态标签

- [x] D1：设计 `TagProps`（`src/components/tag.rs`）：
  - 字段建议：
    - `color: Option<TagColor>`（预设颜色枚举或直接字符串，MVP 先支持预设枚举）；
    - `closable: bool`；
    - `on_close: Option<Callback<()>>`；
    - `checkable: bool` / `checked: Option<bool>` / `default_checked: Option<bool>` / `on_change: Option<Callback<bool>>`；
    - `class` / `style`；
    - `children: Element`（标签文本/内容）。
- [x] D2：实现 `Tag` 组件：
  - 渲染 `.adui-tag` 根，支持不同色彩类 `.adui-tag-{color}`；
  - closable 时在右侧渲染关闭 icon，点击触发 on_close；
  - checkable 标签切换选中态，并通过 `on_change(checked)` 通知外部（受控/非受控模式）。
- [x] D3：在 `src/theme.rs` 中新增 `.adui-tag-*` 样式：
  - 默认/primary/success/warning/error 等预设色；
  - checkable 标签的选中/hover 视觉；
  - 与 Typography/Button/Badge 圆角与高度对齐。
- [x] D4：新增 `examples/tag_demo.rs`：
  - 基础标签列表；
  - 可关闭标签；
  - checkable 标签组，模拟筛选条件选择。
- [x] D5：文档：新增 `docs/tag.md`：
  - Tag API 与典型用法；
  - Table/List 中使用 Tag 表达状态的推荐方案。

---

### E. Badge：角标与小红点

- [x] E1：设计 `BadgeProps`（`src/components/badge.rs`）：
  - 字段建议：
    - `count: Option<u32>`；
    - `overflow_count: u32`（默认 99）；
    - `dot: bool`；
    - `show_zero: bool`；
    - `offset: Option<(i32, i32)>`（微调位置，MVP 可暂不实现）；
    - `status: Option<BadgeStatus>`（MVP 可不实现或仅支持少量枚举）；
    - `class` / `style`；
    - `children: Option<Element>`（承载的目标元素，例如 Icon/Button/MenuItem）。
- [x] E2：实现 `Badge` 组件：
  - 渲染 `.adui-badge` 包裹 children，并在右上角渲染 `.adui-badge-count` 或 `.adui-badge-dot`；
  - `count` 超过 `overflow_count` 时展示 `"{overflow_count}+"`；
  - `count = 0` 且 `show_zero=false` 时不展示；
  - `dot=true` 时忽略 count，显示小红点。
- [x] E3：在 `src/theme.rs` 中新增 `.adui-badge-*` 样式：
  - 位置/尺寸/颜色；
  - 与 FloatButton/Avatar/Menu/Icon 等组合时的对齐策略。
- [x] E4：新增 `examples/badge_demo.rs`：
  - Icon/Button 上的数字角标；
  - 小红点通知；
  - 与 Menu/Avatar 组合的顶部导航示例。
- [x] E5：文档：新增 `docs/badge.md`：
  - Badge API 与 count/dot/overflowCount 行为；
  - 与 Layout Header / Menu / FloatButton 组合的示例。

---

### F. Avatar：头像

- [x] F1：设计 `AvatarProps`（`src/components/avatar.rs`）：
  - 字段建议：
    - `src: Option<String>`；
    - `alt: Option<String>`；
    - `shape: Option<AvatarShape>`（Circle/Square，默认 Circle）；
    - `size: Option<AvatarSize>`（Small/Default/Large/Number）；
    - `gap: Option<u8>`（文字头像内边距，MVP 可选）；
    - `icon: Option<Element>`；
    - `class` / `style`；
    - `children: Option<Element>`（文字头像内容）。
- [x] F2：实现 `Avatar` 组件：
  - 优先渲染图片，加载失败时 fallback 到 icon 或文字；
  - 渲染 `.adui-avatar` / `.adui-avatar-{shape}` / `.adui-avatar-{size}`；
  - 支持 `AvatarGroup`（可选）：简单一排重叠头像，MVP 可先只支持水平排列，不实现溢出计数。
- [x] F3：在 `src/theme.rs` 中新增 `.adui-avatar-*` 样式：
  - 尺寸/圆角/背景色/文字对齐；
  - group 中的重叠/边框处理。
- [x] F4：新增 `examples/avatar_demo.rs`：
  - 单个头像（图片/文字/icon）；
  - 不同尺寸/形状；
  - AvatarGroup 示例（多个用户头像）。
- [x] F5：文档：新增 `docs/avatar.md`：
  - Avatar API、fallback 行为；
  - 与 Badge/Dropdown/Menu/Header 组合的用户信息区域示例。

---

### G. 集成验证与收尾

- [x] G1：构建一个综合示例：`examples/dashboard_demo.rs`（名称可调整）：
  - 使用 Layout + Menu + Breadcrumb + Tabs + Card + Tag + Badge + Avatar + List/Pagination；
  - 模拟「用户中心 / 仪表盘 / 设置页」中的典型布局和交互；
  - 验证 Tabs 切换、卡片布局、标签状态、角标通知以及头像区域的组合是否自然。
- [x] G2：全量运行 `cargo fmt` / `cargo clippy --all-targets --all-features` / `cargo test`，并记录：
  - 已在本轮末尾执行一次上述三条命令，确保新增 Tabs/Card/Tag/Badge/Avatar/dashboard_demo 无编译错误，仅保留若干已有的 clippy 提示（如 `unused_mut`、`clone_on_copy` 等）。
  - 为 Tabs/Card/Tag/Badge/Avatar 增补了若干轻量级单元测试（例如 TabItem 与初始 active key 解析、Card/Badge 类名与展示逻辑等）。
- [x] G3：整理文档与索引：
  - 在 `docs/README.md` 中增加 Tabs/Card/Tag/Badge/Avatar 的条目与链接；
  - 在 Layout/Menu/Pagination/List/Table 文档中补充对这些组件与综合示例 `dashboard_demo` 的组合示例链接；
  - `docs/app_config.md` 中新增「导航 + 卡片 + 标签/角标 组合规划（Tabs / Card / Tag / Badge / Avatar）」小节，说明与 Layout/Menu/List/Table 等的搭配建议。
