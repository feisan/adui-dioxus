# 任务计划：流程与结果反馈 Alert / Result / Progress / Statistic / Steps（Phase 9）

## 一、背景与本轮目标

前几轮（`plan/0001`–`0011`）已经完成：

- 布局与导航：Layout / Grid / Flex / Space / Masonry / Splitter / Menu / Breadcrumb / Pagination；
- 表单与输入：Input / TextArea / Checkbox / Radio / Switch / Upload + Form 高级能力；
- 选择器家族：Select / TreeSelect / Cascader / AutoComplete，与 Form 深度集成；
- 浮层体系：App / ConfigProvider / OverlayManager / Tooltip / Popover / Popconfirm / Dropdown / Modal / Drawer / Message / Notification；
- 数据展示与状态：Typography / Divider / List / Table / Empty / Spin / Skeleton / FloatButton；
- 卡片与页签：Tabs / Card / Tag / Badge / Avatar；
- 组合示例：`layout_navigation_demo`、`data_view_demo`、`dashboard_demo` 等，覆盖典型列表页与仪表盘。

对照 Ant Design 6.0，当前在「流程与结果反馈」这一层还有明显空档：

- `Alert`：页面内重要提示/警告（错误横幅、轻量消息）；
- `Result`：操作结果页（成功/失败/等待/403/404/500 等）；
- `Progress`：任务进度（线形、圆形、仪表盘）；
- `Statistic`：数字统计（关键指标数值展示）；
- `Steps`：流程步骤条（注册向导、多步表单、审批流程等）。

本轮（Phase 9）目标：

- 设计并实现 Alert / Result / Progress / Statistic / Steps 的 MVP 版本；
- 与现有 Layout / Card / Tabs / Tag / Badge / Message / Modal / Form / List / Table 深度协同，补齐「流程 + 进度 + 结果」的常见场景；
- 通过 demo 与文档沉淀一套「多步流程 + 结果页」的推荐组合方式。

> 仍采用 MVP 策略：优先覆盖业务中常见用法，暂不追求 AntD 在动画、所有视觉变体和极端边界状态上的完全对齐。

---

## 二、设计原则

1. **对齐 AntD 语义，裁剪复杂变体**
   - Alert：先支持 `type`（success/info/warning/error）+ `showIcon` + `closable`，暂不实现复杂 banner/描述布局/自定义 icon 动画；
   - Result：提供基础结果类型（success/error/warning/info/404/500）与标题/子标题/extra 区域，暂不实现所有插画样式；
   - Progress：优先线形进度条 + 简单圆形，支持 `percent`/`status`，不实现仪表盘/渐变色/分段色；
   - Statistic：先实现简单数值 + 前后缀（prefix/suffix）与格式化，暂不支持倒计时等高级模式；
   - Steps：支持水平步骤条 + `current`/`status`/`onChange`，MVP 不实现 progress-dot/纵向/导航型步骤条等复杂形态。

2. **与 Theme/ConfigProvider 统一**
   - 尺寸：受 `ComponentSize` 影响（small/middle/large），Alert/Result/Progress/Statistic/Steps 的高度与 Typography/Button/Card 对齐；
   - 颜色：复用现有主题 token（primary/success/warning/error/text/border），避免组件内部硬编码色值；
   - 圆角与阴影：沿用 `--adui-radius` / `--adui-radius-sm` 与 Card/List/Table 的统一视觉。

3. **受控优先 + 简单非受控兜底**
   - Steps：`current` 受控优先，提供 `default_current` 作为非受控初始值；
   - Progress：`percent` 为受控属性，不在内部隐式计时；
   - Alert/Result/Statistic：展示类组件保持受控；
   - 可关闭 Alert 等支持在内部维护简单可见性状态，并通过回调通知外层。

4. **组合优先，避免重复造轮子**
   - Result/Statistic/Progress/Alert 优先作为 Card/Tabs/List/Table 等的内容，而非另起一套布局体系；
   - Steps 不负责表单校验与数据持久，仅负责步骤导航，表单逻辑交给 Form + Modal/Drawer；
   - 与 Message/Notification 形成“轻提示（Message）→ 过程（Progress/Steps）→ 结果页（Result/Alert/Statistic）”闭环。

5. **文档清晰标注与 AntD 差异**
   - 每个组件文档中明确当前缺失的能力和后续扩展方向（例如 Progress 仪表盘、Steps progress-dot 模式等），避免误用；
   - 在 App/ConfigProvider 文档中补充流程类组件的组合建议（如 Form + Steps + Result）。

---

## 三、任务拆解与 TODO

### A. 能力范围梳理与 API 草案

- [x] A1：调研 `tmp/antd-6.0.0/es` 下以下目录源码与类型声明：
  - `alert` / `result` / `progress` / `statistic` / `steps`；
  - 结论：
    - Alert：`AlertProps` 以 `type`（success/info/warning/error）、`closable`、`title`/`message`/`description`、`showIcon`、`icon` 为核心，并带有 `onClose`/`afterClose`、`banner` 等增强属性；
    - Result：`ResultProps` 主要包含 `status`（success/info/warning/error/403/404/500）、`icon`、`title`、`subTitle`、`extra`、`children` 等，内部通过 `IconMap` / `ExceptionMap` 选择默认图标/插画；
    - Progress：`ProgressProps` 支持 `type`（line/circle/dashboard）、`percent`、`status`（normal/exception/active/success）、`showInfo`、`strokeWidth`、`strokeColor`、`trailColor` 等，另有丰富的 size/gap/steps 配置；
    - Statistic：`StatisticProps` 通过 `value` + `FormatConfig`（precision、groupSeparator 等）控制数值格式，支持 `title`、`prefix`、`suffix`、`loading` 和自定义 `valueRender`；
    - Steps：`StepsProps` 基于 `items: StepItem[]`，每项包含 `title`/`subTitle`/`content`/`status`/`disabled` 等，整体支持 `current`/`status`/`onChange`，并有多种 `type`/`orientation` 但核心是水平线型步骤条。
- [x] A2：结合当前组件能力，确认本轮 **MVP API 范围**：
  - Alert：基础消息条 + 四种状态色 + 可关闭 + 可选 icon；
  - Result：若干预设状态（success/error/info/warning/404/500）+ 标题/描述/extra slot；
  - Progress：线形+简单圆形进度，支持 percent/status/show_info；不实现仪表盘/渐变色；
  - Statistic：单值展示 + prefix/suffix + precision；暂不实现倒计时；
  - Steps：水平步骤条 + current/status/on_change；不实现多方向/导航型阶梯等。
- [x] A3：在 `docs/app_config.md` 或新的流程文档中增加「流程与结果反馈」小节：
  - 已在 `docs/app_config.md` 中新增「流程与结果反馈规划（Alert / Result / Progress / Statistic / Steps）」一节，说明这些组件在多步表单、长任务与结果页中的定位，以及与 Form/Modal/Message/Notification/Tabs/Card 的组合建议。

---

### B. Alert：页面级提示

- [x] B1：设计 `AlertProps`（`src/components/alert.rs`）：
  - 字段建议：
    - `r#type: AlertType`（Success/Info/Warning/Error，默认 Info）；
    - `message: Element`（主消息文本）；
    - `description: Option<Element>`（可选详细说明）；
    - `show_icon: bool`；
    - `closable: bool` / `on_close: Option<EventHandler<()>>`；
    - `banner: bool`（MVP 可仅影响样式，不实现复杂布局）；
    - `class` / `style`；
  - `AlertType` 枚举采用与 Tag/Badge 一致的语义（Success/Warning/Error/Info）。
- [x] B2：实现 `Alert` 组件：
  - 渲染结构：`.adui-alert` 根 + `.adui-alert-icon` + `.adui-alert-message` + `.adui-alert-description` + `.adui-alert-close-icon`；
  - 支持 `closable` 时渲染关闭按钮，点击后触发 `on_close`，并在非受控模式下隐藏自身；
  - 支持 `show_icon` 时根据 `r#type` 渲染不同语义 icon（可复用已有 `IconKind`）。
- [x] B3：在 `src/theme.rs` 中新增 `.adui-alert-*` 样式：
  - 不同类型的背景/边框/文字色；
  - banner 模式的全宽条形样式；
  - 与 Typography/Button/Card 统一的间距与圆角。
- [x] B4：新增 `examples/alert_demo.rs`：
  - 基础四种类型 Alert；
  - 带 description 的复杂提示；
  - 可关闭 Alert（演示 on_close 与内部隐藏行为）。
- [x] B5：文档：新增 `docs/alert.md`：
  - 描述 Alert API、受控/非受控关闭行为；
  - 与 Message/Notification 的使用边界（何时用页面内 Alert，何时用全局反馈）。

---

### C. Result：操作结果页

- [x] C1：设计 `ResultProps`（`src/components/result.rs`）：
  - 字段建议：
    - `status: ResultStatus`（Success/Error/Info/Warning/404/500 等）；
    - `title: Element`；
    - `sub_title: Option<Element>`；
    - `icon: Option<Element>`（覆盖默认 icon）；
    - `extra: Option<Element>`（操作区域，常用于按钮组）；
    - `class` / `style`；
    - `children: Option<Element>`（扩展内容，例如步骤说明或列表）。
- [x] C2：实现 `Result` 组件：
  - DOM 结构对齐 AntD：`.adui-result` 根 + `.adui-result-icon` + `.adui-result-title` + `.adui-result-subtitle` + `.adui-result-extra` + `.adui-result-content`；
  - 根据 `status` 切换默认图标（可用简化版 Icon，而非完整插画）；
  - 支持在 `Card` 或独立页中使用。
- [x] C3：在 `src/theme.rs` 中新增 `.adui-result-*` 样式：
  - 标题、状态 icon 与 extra 区域布局；
  - 适配页内/整页场景（例如居中布局、宽度限制等）。
- [x] C4：新增 `examples/result_demo.rs`：
  - 成功/失败结果页示例（包含操作按钮）；
  - 404/500 等简单错误页示例；
  - 与 Layout/Page + Card 组合的结果页模板。
- [x] C5：文档：新增 `docs/result.md`：
  - 说明 Result API 与典型场景；
  - 推荐与 Steps/Form/Alert/Message 组合使用的模式（例如多步表单成功后跳转 Result）。

---

### D. Progress：进度条

- [x] D1：设计 `ProgressProps`（`src/components/progress.rs`）：
  - 字段建议：
    - `percent: f32`（0.0–100.0）；
    - `status: Option<ProgressStatus>`（normal/success/exception/active 等）；
    - `show_info: bool`（是否显示文本百分比）；
    - `r#type: ProgressType`（Line/Circle，MVP 不做 Dashboard）；
    - `stroke_width: Option<f32>`；
    - `class` / `style`；
  - `ProgressStatus` 和 `ProgressType` 使用简单枚举。
- [x] D2：实现 `Progress` 组件：
  - Line 类型：
    - `.adui-progress` 根 + `.adui-progress-outer` + `.adui-progress-inner` + `.adui-progress-bg`；
    - 通过 inline style 控制宽度（百分比）；
  - Circle 类型：
    - 可用 SVG 圆环实现或简化为占位圆，仅支持基本百分比显示；
  - 根据 `status` 切换颜色与可选 icon（例如完成/异常）。
- [x] D3：在 `src/theme.rs` 中新增 `.adui-progress-*` 样式：
  - 线形进度条高度、圆角与背景条；
  - 状态色（primary/success/error 等）；
  - 文字信息位置（右侧或内部）。
- [x] D4：新增 `examples/progress_demo.rs`：
  - 不同百分比/状态/是否显示 info；
  - Circle 进度示例；
  - 与 Button 模拟上传/任务进度联动（利用 Dioxus signal 模拟进度变化）。
- [x] D5：文档：新增 `docs/progress.md`：
  - Progress API 与状态语义；
  - 与 Steps/Result 组合展示长任务状态的建议。

---

### E. Statistic：数字统计

- [x] E1：设计 `StatisticProps`（`src/components/statistic.rs`）：
  - 字段建议：
    - `title: Option<Element>`；
    - `value: f64` 或基于字符串的 `value_text: String`；
    - `precision: Option<u8>`；
    - `prefix: Option<Element>` / `suffix: Option<Element>`；
    - `value_style: Option<String>`（内联 style，用于快速调整颜色，例如绿色/红色）；
    - `class` / `style`；
  - 可以考虑辅助函数用于格式化千分位/百分比等。
- [x] E2：实现 `Statistic` 组件：
  - DOM 结构：`.adui-statistic` 根 + `.adui-statistic-title` + `.adui-statistic-content` + `.adui-statistic-prefix` + `.adui-statistic-value` + `.adui-statistic-suffix`；
  - 使用内部格式化函数将 `value` + `precision` 转为展示文本。
- [x] E3：在 `src/theme.rs` 中新增 `.adui-statistic-*` 样式：
  - 标题与数值排版；
  - 与 Card/List 中的统计卡片组合时的间距与字号；
  - 支持在仪表盘卡片中多列排布。
- [x] E4：新增 `examples/statistic_demo.rs`：
  - 基础数值统计卡片（可组合 Card）；
  - 使用 prefix/suffix 表示增长/比例等；
  - 与 Progress/Tag 组合展示“完成率 + 环比变化”。
- [x] E5：文档：新增 `docs/statistic.md`：
  - 说明 Statistic API 与格式化策略；
  - 展示与 Card/Grid/Tabs 组合成统计面板的用法。

---

### F. Steps：流程步骤条

- [x] F1：设计 `StepsProps` 与 `StepItem` 模型（`src/components/steps.rs`）：
  - `StepItem` 字段建议：
    - `key: String`；
    - `title: Element`；
    - `description: Option<Element>`；
    - `status: Option<StepStatus>`（wait/process/finish/error）；
    - `disabled: bool`；
  - `StepsProps` 字段建议：
    - `items: Vec<StepItem>`；
    - `current: Option<usize>` / `default_current: Option<usize>`；
    - `on_change: Option<EventHandler<usize>>`（点击步骤时触发）；
    - `direction: Option<StepsDirection>`（MVP 仅支持 Horizontal）；
    - `class` / `style`；
    - `size: Option<ComponentSize>`。
- [x] F2：实现 `Steps` 组件：
  - DOM 结构：`.adui-steps` 根 + `.adui-steps-item` 列表；
  - 使用 `current` 和 `StepStatus` 决定每个步骤的图标/颜色（等待/进行中/完成/错误）；
  - 支持点击可用步骤时调用 `on_change`，用于外层切换 Tab 或表单页面；
  - 暂不实现 progress-dot、navigation 类型，仅做基础线型步骤条。
- [x] F3：在 `src/theme.rs` 中新增 `.adui-steps-*` 样式：
  - 水平步骤条线段与圆圈/数字样式；
  - current/finish/error 状态配色；
  - 小号/默认尺寸差异。
- [x] F4：新增 `examples/steps_demo.rs`：
  - 基础步骤条；
  - 与 Form/Modal/Result 简单组合的多步流程示例（例如三步注册流程）；
  - 展示点击步骤切换当前步骤的受控用法。
- [x] F5：文档：新增 `docs/steps.md`：
  - Steps API 与状态说明；
  - 与 Form/Result/Tabs/Card 组合构建多步表单和流程向导的示例。

---

### G. 集成验证与收尾

- [x] G1：构建一个综合示例：`examples/flow_feedback_demo.rs`（名称可调整）：
  - 使用 Steps + Form + Progress + Alert/Message + Result/Statistic + Card/Layout；
  - 模拟典型多步操作流程（例如“创建应用向导”：填写基础信息 → 配置权限 → 完成结果页）；
  - 验证步骤切换、进度展示、错误提示与结果页之间的交互是否自然。
- [x] G2：在本轮完成后全量运行 `cargo fmt` / `cargo clippy --all-targets --all-features` / `cargo test`，并记录：
  - 新增模块的 clippy 建议；
  - 为关键逻辑添加必要的单元测试（如 Progress 百分比计算、Steps 受控/非受控 current 行为、Result 预设状态映射等）。
- [x] G3：整理文档与索引：
  - 在 `docs/README.md` 中增加 Alert/Result/Progress/Statistic/Steps 的条目与链接；
  - 在 `docs/app_config.md` 中扩展「流程与结果反馈」小节，链接到本轮组件与综合示例；
  - 在 Layout/Tabs/Card/Form/List/Table 等文档中补充对流程/结果类组件的组合示例链接。