# 任务计划：列表与加载状态 List / Table / Empty / Spin / Skeleton（Phase 7）

## 一、背景与本轮目标

前几轮（`plan/0001`–`0009`）已经完成：

- 布局与导航：Layout / Grid / Flex / Space / Masonry / Splitter / Menu / Breadcrumb / Pagination；
- 表单与输入：Input / TextArea / Checkbox / Radio / Switch / Upload + Form 高级能力；
- 选择器家族：Select / TreeSelect / Cascader / AutoComplete，与 Form 深度集成；
- 浮层体系：App / ConfigProvider / OverlayManager / Message / Notification / Modal / Drawer / Tooltip / Popover / Popconfirm / Dropdown；
- 导航综合示例：`layout_navigation_demo` 复用了 Menu + Breadcrumb + Pagination。

在 Ant Design 体系中，另一条非常重要的轴是「数据展示 + 状态反馈」：

- `List`：列表视图，适合中轻量数据展示；
- `Table`：结构化数据表格，是中后台的核心组件；
- `Empty`：统一的空状态视觉；
- `Spin`：通用加载指示器；
- `Skeleton`：骨架屏，占位式加载体验。

目前仓库里还没有对应的 Rust/Dioxus 实现，但已有的 Layout / Typography / Pagination / Overlay 等基础设施已经基本完备。本轮（Phase 7）目标：

- 设计并实现 MVP 版本的 List / Table / Empty / Spin / Skeleton；
- 与 Pagination / Layout / Typography 等现有组件建立协同关系，形成可复用的「列表页模板」基础；
- 为后续更复杂的数据展示（如高级 Table 功能、虚拟滚动、大数据量加载）打下 API 和样式基础。

> 仍然采用 MVP 策略：优先覆盖常见用法（简单列表、基础表格、统一的 loading/empty 展示），暂不追求 AntD 所有高级特性（虚拟滚动、列拖拽、自定义过滤器、复杂统计等）。

---

## 二、设计原则

1. **与现有组件协同，而不是重复造轮子**
   - List / Table 不重复实现分页逻辑，优先复用现有 `Pagination` 组件；
   - loading/empty 优先通过 `Spin`/`Skeleton`/`Empty` 组合，而不是在每个组件内部发明一套；
   - 尽量让 Layout / Menu / Breadcrumb / Pagination + List/Table 组合出常见「列表页模板」。

2. **对齐 AntD 的核心语义，裁剪复杂分支**
   - Empty：先实现基础 `description` 与几种图标/尺寸，暂不支持完全自定义 SVG 集合；
   - Spin：支持 `spinning` + `tip` + `size`，延迟/自定义指示器等能力视情况裁剪；
   - Skeleton：先实现基础矩形骨架（标题 + 段落）+ `active` 动画，Avatar/Button/Input 型骨架可以后续扩展；
   - List：支持 header/footer + `data_source` + `render_item`，MVP 不做虚拟滚动与复杂栅格；
   - Table：支持基础列定义/表头/分页/排序的 MVP 子集，复杂功能（合并单元格、树形数据、固定列、拖拽）后续再引入。

3. **组件独立 + 受控优先**
   - List/Table 的分页/排序参数优先采用受控模式（由上层状态驱动），内部非受控作为兜底；
   - Spin/Skeleton/Empty 本身尽量保持“傻组件”，不持久化业务状态；
   - Table 对数据源和列定义保持纯函数式渲染，不在内部藏业务逻辑。

4. **样式与主题统一**
   - 继续使用主题 token（颜色/圆角/间距）与 `ConfigProvider` 的 size 体系；
   - 类名风格对齐 AntD：`.adui-list-*` / `.adui-table-*` / `.adui-empty-*` / `.adui-spin-*` / `.adui-skeleton-*`；
   - 避免大段 inline style，优先集中在 `src/theme.rs` 的样式片段中。

5. **文档与差异明确**
   - 每个组件的文档中，明确与 AntD 6.0 的对齐点与缺失能力；
   - 对虚拟滚动、大数据量、复杂交互的支持规划，记录在文档与 plan 中，避免误用。

---

## 三、任务拆解与 TODO

### A. 能力范围梳理与 API 草案

- [x] A1：调研 `tmp/antd-6.0.0/es` 下以下目录源码与类型声明：
  - `list` / `table` / `empty` / `spin` / `skeleton`；
  - 辅助目录：`_util` / `style` / `config-provider` 中涉及 size 与方向的部分；
  - 重点关注：
    - Empty：`EmptyProps`、内置图片/大小、与 `List`/`Table`/`Select` 的协同用法；
    - Spin：`SpinProps`（`spinning`/`size`/`tip`/`delay`）、包裹内容时的布局策略；
    - Skeleton：`SkeletonProps` 与 `Skeleton.Button` / `Skeleton.Input` 等子组件；
    - List：`ListProps`（`dataSource`/`renderItem`/`header`/`footer`/`loadMore`/`pagination` 等）；
    - Table：`TableProps` 与 `ColumnType`（`dataIndex`/`title`/`render`/`sorter`/`align`/`fixed` 等）。
- [x] A2：结合当前 Layout / Typography / Pagination / Overlay 能力，提炼本轮 **MVP 范围**：
  - Empty：
    - 支持简单的 `description` 文本与几种视觉风格（默认/简单/小型）；
    - 支持自定义 children，作为额外操作入口（例如“新建”按钮）；
    - 暂不提供复杂图片库，可用简单占位图标代替。
  - Spin：
    - 支持包裹任意子内容，`spinning=false` 时渲染原始内容；
    - 支持 `size`（small/default/large）与 `tip`；
    - 暂不实现 `delay`、自定义指示器，只预留接口或文档规划。
  - Skeleton：
    - 基础 `Skeleton` 组件支持 `loading`/`active`/`title`/`paragraph` 配置；
    - 预留 `SkeletonAvatar` / `SkeletonButton` / `SkeletonInput` 名字，但本轮只实现一两种简单变体；
    - 暂不支持复杂布局组合（如多列骨架）。
  - List：
    - 支持 `header`/`footer` 文本或 slot；
    - 支持 `data: Vec<T>` + `render_item: Fn(&T) -> Element` 的模式（Rust 版本可通过泛型或 `Value`/`Element` 模型简化）；
    - 支持 `loading`（结合 Spin/Skeleton）与 `empty`（结合 Empty）；
    - 支持简单分页：外部完全受控，或内部通过 `Pagination` 简化包装。
  - Table：
    - 支持 `columns` 数组 + `data` 数据源；
    - 支持基本排序（单字段、同步排序逻辑）；
    - 支持外部 pagination 配置（受控），内部渲染 `Pagination`；
    - 暂不实现：列固定、横向滚动、树形数据、列拖拽、筛选面板等高级功能。
- [x] A3：在 `docs/app_config.md` 中增加一小节「数据展示与加载组件规划」，简述：
  - List / Table 与 Pagination / Layout / Typography 的关系；
  - Empty / Spin / Skeleton 在列表/表格/详情页等场景中的统一用法；
  - 与 Form/Overlay 的边界（例如：表格内编辑 vs Modal 弹窗编辑）。

---

### B. Empty：统一空状态

- [x] B1：设计 `EmptyProps` 与数据模型（`src/components/empty.rs`）：
  - 字段建议：
    - `description: Option<String>`；
    - `image: Option<EmptyImage>`（枚举：Default / Simple / Small / Custom(String)）；
    - `class: Option<String>` / `style: Option<String>`；
    - `children: Option<Element>`（例如“新建”按钮）。
- [x] B2：实现 `Empty` 组件：
  - 在 `src/components/empty.rs` 中实现；
  - 提供基础 DOM 结构，如：
    - `.adui-empty` / `.adui-empty-image` / `.adui-empty-description` / `.adui-empty-footer`；
  - 支持通过 `ConfigProvider` 的 size 或主题 tokens 调整间距与字体大小（MVP 可先简单实现）。
- [x] B3：在 `src/theme.rs` 中补充 `.adui-empty-*` 样式：
  - 对齐 AntD 默认 Empty 视觉（居中、灰色占位图、主/次文本色）；
  - 提供 `small` 变体的样式钩子（例如 `.adui-empty-sm`）。
- [x] B4：新增 demo：`examples/empty_demo.rs`：
  - 展示基础 Empty；
  - 展示带额外操作按钮的 Empty（例如“创建第一个项目”）；
  - 展示 small/simple 风格对比。
- [x] B5：文档：新增 `docs/empty.md`：
  - 描述 Empty API 与典型用法；
  - 建议在 List/Table/Select 为空时统一使用 Empty，并记录预期集成方式（后续与 List/Table 文档交叉引用）。

---

### C. Spin：加载指示器

- [x] C1：设计 `SpinProps` 与使用模式：
  - 字段建议：
    - `spinning: bool`（默认 true）；
    - `size: Option<SpinSize>`（`Small/Default/Large`）；
    - `tip: Option<String>`；
    - `class` / `style`；
    - 支持作为容器包裹 children：`Spin { spinning: true, children: rsx!(...) }`。
- [x] C2：实现 `Spin` 组件（`src/components/spin.rs`）：
  - 渲染基础结构：
    - `.adui-spin`（根容器）；
    - `.adui-spin-dot` / `.adui-spin-dot-item`（指示器）；
    - `.adui-spin-text`（tip 文本）；
    - 包裹内容时，为包裹内容添加 `.adui-spin-nested-loading` 等类名，参考 AntD。
  - 仅在 `spinning` 为 true 时显示指示器，false 时只渲染 children。
- [x] C3：在 `src/theme.rs` 中补充 `.adui-spin-*` 样式：
  - 指示器动画（旋转的小点或简单圆环）；
  - 不同 size 的尺寸与间距；
  - 嵌套模式下的半透明遮罩背景（MVP 可简化）。
- [x] C4：新增 demo：`examples/spin_demo.rs`：
  - 基础 Spin（仅指示器）；
  - 嵌套 Spin 包裹卡片内容，展示 loading 切换；
  - 不同 size 与 tip 示例。
- [x] C5：文档：新增 `docs/spin.md`：
  - 描述 `Spin` 的 API 与嵌套用法；
  - 说明与 Skeleton 的差异（Spin 更适合不定形内容的短暂 loading，Skeleton 更适合页面骨架）。

---

### D. Skeleton：骨架屏

- [x] D1：设计 `SkeletonProps` 及几个简单子变体：
  - `SkeletonProps` 字段建议：
    - `loading: Option<bool>`（默认 `Some(true)`，`None` 表示只渲染骨架，不包裹子内容）；
    - `active: bool`（是否显示动画）；
    - `title: bool` / `paragraph_rows: u8`；
    - `class` / `style`；
    - children：当 `loading=false` 时渲染实际内容，类似 AntD 行为；
  - 预留简单变体结构：`SkeletonAvatar` / `SkeletonButton` / `SkeletonInput`，MVP 先实现其中 1–2 个代表性变体即可。
- [x] D2：实现 `Skeleton` 组件（`src/components/skeleton.rs`）：
  - 渲染结构：
    - `.adui-skeleton` 根；
    - `.adui-skeleton-header`（可选 avatar 区）；
    - `.adui-skeleton-content` 内部 title + paragraph 行；
    - `.adui-skeleton-title` / `.adui-skeleton-paragraph` / `.adui-skeleton-paragraph-line-*`；
  - 根据 `loading` 决定渲染骨架还是 children；
  - `active` 决定是否启用骨架动画 class。
- [x] D3：在 `src/theme.rs` 中补充 `.adui-skeleton-*` 样式：
  - 基础灰色块 + 圆角 + 渐变动画；
  - 适配不同行数、高度与间距。
- [x] D4：新增 demo：`examples/skeleton_demo.rs`：
  - 展示纯骨架用法；
  - 展示 `loading` 包裹真实内容的用法（加载完成后骨架消失）；
  - 展示 active 与非 active 的视觉差异。
- [x] D5：文档：新增 `docs/skeleton.md`：
  - 记录 Skeleton API、典型布局组合；
  - 与 Spin 的配合使用建议（如局部 Skeleton + 全局 Spin）。

---

### E. List：列表视图

- [x] E1：设计 `ListProps` 与数据模型（`src/components/list.rs`）：
  - 建议：
    - `data: Vec<T>` 或通过中性模型 `Vec<ListItem>`；
    - `render_item: Callback<&T>` 或 `render_item: Callback<ListItem>`（需结合 Dioxus 限制设计）；
    - `header: Option<Element>` / `footer: Option<Element>`；
    - `bordered: bool` / `size: ComponentSize`；
    - `loading: bool` / `empty: Option<Element>`；
    - `pagination: Option<ListPaginationConfig>`（简化版，只包含 `current` / `page_size` / `total` / `on_change`，内部复用 Pagination）。
- [x] E2：实现 `List` 组件：
  - 结构：
    - `.adui-list` 根容器；
    - `.adui-list-header` / `.adui-list-footer`；
    - `.adui-list-items` / `.adui-list-item`；
  - 根据 `loading` 决定是否用 Spin/Skeleton 包裹；
  - 当 `data` 为空且 `loading=false` 时，渲染 `empty` slot 或默认 `Empty`。
- [x] E3：在 `src/theme.rs` 中补充 `.adui-list-*` 样式：
  - 对齐 AntD 基础视觉：标题/内容对齐、分割线、紧凑/默认尺寸；
  - 支持横向列表（MVP 可暂不实现复杂 grid 模式，只留 class 钩子）。
- [x] E4：新增 demo：`examples/list_demo.rs`：
  - 基本列表（无分页）；
  - 带分页的列表（内部或外部受控）；
  - 空列表 + Empty 展示；
  - loading 切换 + Spin/Skeleton 效果。
- [x] E5：文档：新增 `docs/list.md`：
  - 记录 List API 与典型用法；
  - 展示 List + Pagination + Empty + Spin/Skeleton 组合的推荐模式；
  - 对比 AntD 的差异（不支持虚拟滚动、网格布局、loadMore/infinite scroll 等）。

---

### F. Table：数据表格

- [x] F1：设计 `TableColumn` / `TableProps` 与数据模型（`src/components/table.rs`）：
  - `TableColumn` 建议字段：
    - `key: String` / `data_index: String`；
    - `title: Element`（或简单 `String`）；
    - `width: Option<f32>`；
    - `align: Option<ColumnAlign>`；
    - `render: Option<Callback<TableCellRenderContext>>`（MVP 可简化为 `Fn(&Row) -> Element`）；
    - `sortable: bool` 及简单排序标记；
  - `TableProps` 建议字段：
    - `columns: Vec<TableColumn>`；
    - `data: Vec<Row>`（Row 模型可用 `serde_json::Value` 或自定义 `TableRow`）；
    - `row_key: Option<RowKeyFn>`；
    - `pagination: Option<TablePaginationConfig>`（复用 Pagination）；
    - `loading: bool` / `empty: Option<Element>`；
    - `bordered: bool` / `size: ComponentSize` / `row_class_name` 等基础字段。
- [x] F2：实现 `Table` 组件：
  - 渲染 `<table>` 或 `<div role="table">` 结构：
    - `.adui-table` 根；
    - `.adui-table-header` / `.adui-table-body`；
    - `.adui-table-row` / `.adui-table-cell`；
  - 支持简单排序交互：点击列头切换升序/降序/默认，并通过回调通知外部；
  - 支持 pagination：
    - 若 `pagination` 存在，则在表格底部渲染 Pagination；
    - 交互后通过 `on_change` 将分页/排序状态推给外部（MVP 可简化）。
- [x] F3：在 `src/theme.rs` 中补充 `.adui-table-*` 样式：
  - 基础表格边框、斑马纹（可选）、hover 行效果；
  - 表头背景与排序图标占位。
- [x] F4：新增 demo：`examples/table_demo.rs`：
  - 基本表格（无分页、静态数据）；
  - 带分页表格（外部受控 current/pageSize）；
  - 简单排序示例（例如按年龄排序）。
- [x] F5：文档：新增 `docs/table.md`：
  - 描述 Table API、列定义模型、排序/分页行为；
  - 明确本轮未实现的复杂能力（合并单元格、树形数据、固定列、过滤器等），并给出后续扩展规划。

---

### G. 集成验证与收尾

- [x] G1：构建一个综合示例：`examples/data_view_demo.rs`：
  - 使用 Layout + Menu + Breadcrumb + List/Table + Pagination + Empty + Spin/Skeleton；
  - 模拟一个典型“用户列表”或“订单列表”页面；
  - 验证 loading/empty/pagination/sorting 等常见状态组合的视觉与交互是否合理。
- [x] G2：全量运行 `cargo fmt` / `cargo clippy --all-targets --all-features` / `cargo test`，并记录：
  - 新增模块是否引入新的 clippy 警告或测试；
  - 如有必要，为 List/Table 的关键逻辑（分页切片、排序、Empty/loading 切换）添加单元测试或 snapshot 测试。
- [x] G3：整理文档与索引：
  - 在 `docs/README.md` 中增加 List / Table / Empty / Spin / Skeleton 的条目与链接；
  - 在 `docs/app_config.md` 中追加一小节，说明“导航 + 列表页”推荐组合（Menu/Breadcrumb/Pagination/List/Table/Empty/Spin/Skeleton）；
  - 在现有 demo 文档中引用新的示例（如在 Layout 或 Pagination 文档中链接 `data_view_demo`）。
